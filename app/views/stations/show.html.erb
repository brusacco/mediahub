<!-- Hero Section: Station Header -->
<section class="relative bg-gradient-to-br from-indigo-50 via-white to-slate-50 py-8 lg:py-12">
  <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-12 xl:px-16">
    <div class="mb-6">
      <%= link_to root_path, class: "inline-flex items-center text-sm text-gray-600 hover:text-gray-900 transition-colors duration-200 mb-4" do %>
        <i class="fa-solid fa-arrow-left mr-2"></i>
        Volver al Dashboard
      <% end %>
      <div class="flex items-center gap-6">
        <% if @station.logo.attached? %>
          <%= image_tag @station.logo, size: 150, class: 'flex-shrink-0 rounded-full bg-gray-100 ring-4 ring-white shadow-lg', loading: 'lazy', alt: "#{@station.name} logo" %>
        <% end %>
        <div>
          <h1 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">
            <%= @station.name %>
          </h1>
          <p class="mt-4 text-lg text-gray-600">
            La Estación <span class="font-semibold text-gray-900"><%= @station.name %></span> en los últimos 
            <span class="font-semibold text-gray-900"><%= DAYS_RANGE %> días</span> cuenta con un total de 
            <span class="font-semibold text-indigo-600"><%= number_with_delimiter(@total_clips, delimiter: ".") %></span> clips.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Section: Time Series Analysis -->
<section class="py-12 lg:py-16 bg-white">
  <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-12 xl:px-16">
    <div class="mb-10">
      <h2 class="text-2xl font-bold tracking-tight text-gray-900 sm:text-3xl">
        Análisis Temporal
      </h2>
      <p class="mt-2 text-base text-gray-600">
        Evolución de clips en los últimos <%= DAYS_RANGE %> días
      </p>
    </div>
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 lg:p-8">
      <%= column_chart @clips.group_by_day(:posted_at).count, xtitle: "Fecha", ytitle: "Cant. Clips", label: "Clips", colors: ['indigo'] %>
    </div>
  </div>
</section>

<!-- Section: Recent Videos Table -->
<section class="py-12 lg:py-16 bg-slate-50">
  <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-12 xl:px-16">
    <%= render partial: 'videos/table', locals: { videos: @clips, title: "Clips recientes de #{@station.name}" } %>
  </div>
</section>

<!-- Section: Bigrams Analysis -->
<section class="py-12 lg:py-16 bg-white">
  <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-12 xl:px-16">
    <div class="mb-10">
      <h2 class="text-2xl font-bold tracking-tight text-gray-900 sm:text-3xl">
        Análisis de Bigramas
      </h2>
      <p class="mt-2 text-base text-gray-600">
        Pares de palabras más frecuentes en los clips
      </p>
    </div>
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 lg:p-8">
      <div class="flex flex-wrap gap-2">
        <%= render partial: "tags/tag_pill_array", collection: @bigram_occurrences, cached: true %>
      </div>
      <p class="mt-4 text-sm text-gray-500">
        *Cantidad de veces que aparecen bigramas en los clips
      </p>
    </div>
  </div>
</section>

<!-- Section: Word Cloud -->
<section class="py-12 lg:py-16 bg-slate-50">
  <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-12 xl:px-16">
    <div class="text-center mb-10">
      <h2 class="text-2xl font-bold tracking-tight text-gray-900 sm:text-3xl">
        Nube de Palabras
      </h2>
      <p class="mt-2 text-base text-gray-600 max-w-2xl mx-auto">
        Visualización de las palabras más frecuentes en los clips de esta estación
      </p>
    </div>
    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-8 lg:p-12">
      <div class="min-h-[400px] flex items-center justify-center">
        <% min_max = find_max_and_min_occurrences(@word_occurrences) %>
        <ul class="cloud">
          <% @word_occurrences.shuffle { |a, b| a[1] <=> b[1] }.each do |word, value| %>
            <li data-weight="<%= normalize_to_scale(value, min_max[:max], min_max[:min]) %>"><%= word %></li>
          <%end%>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- Section: Tags Appearance -->
<% if @tags.any? %>
  <section class="py-12 lg:py-16 bg-white no-print">
    <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-12 xl:px-16">
      <div class="mb-10">
        <h2 class="text-2xl font-bold tracking-tight text-gray-900 sm:text-3xl">
          Aparición de Etiquetas
        </h2>
        <p class="mt-2 text-base text-gray-600">
          Frecuencia de etiquetas en los clips de esta estación
        </p>
      </div>
      <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 lg:p-8">
        <div class="flex flex-wrap gap-2">
          <%= render partial: "tags/tag_pill", collection: @tags, cached: true %>
        </div>
        <p class="mt-4 text-sm text-gray-500">
          *Cantidad de veces que aparecen las etiquetas en los clips
        </p>
      </div>
    </div>
  </section>
<% end %>
